package com.service;

import org.joda.time.DateTime;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.web.multipart.MultipartFile;

import com.mapper.picMapper;
import com.pojo.picpojo;
import com.util.FtpUtil;

@Service
public class ImageService {
	
	final String host = "127.0.0.1";
	final int port = 21;
	final String username = "to";
	final String password = "zxc123456";
	final String basePath = "/pic";
	

	@Autowired
	private picMapper mapper;

	public void addPic(MultipartFile file) {
		String originalFilename = file.getOriginalFilename();
		String suffix = originalFilename.substring(originalFilename.indexOf("."));
		
		DateTime dateTime = new DateTime();
		String name = dateTime.toString("/yyyy/MM/dd");
		String filePath = dateTime.toString("/yyyy/MM/dd");
		FtpUtil.uploadPic(host, port, username, password, basePath, filePath, name, file.getInputStream());
		
		mapper.insertPic(picpojo);
	}
	
	public picpojo lookPic(String name){
		return mapper.selectPic(name);
	}
	
	

}
